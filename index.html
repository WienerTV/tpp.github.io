<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆç”¨ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸</title>
    <style>
        /* --- å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        body {
            font-family: sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            color: #333;
        }

        /* --- å‹•ç”»ã‚³ãƒ³ãƒ†ãƒŠé–¢é€£ --- */
        .video-container {
            position: relative;
            width: 90%;
            max-width: 800px;
            margin: 20px auto;
            border: 1px solid #ccc;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            background-color: #000;
        }

        .video-container video {
            width: 100%;
            height: auto;
            display: block;
        }

        .ad-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* --- UIè¦ç´  --- */
        #play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-top: 30px solid transparent;
            border-bottom: 30px solid transparent;
            border-left: 50px solid rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: border-left-color 0.2s ease;
        }

        #play-button:hover {
            border-left-color: white;
        }

        #skip-button {
            position: absolute;
            bottom: 5%;
            right: 5%;
            width: 25%;
            max-width: 130px;
            padding: 1.5% 0;
            font-size: 2vw;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border: 1px solid white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            display: none; /* åˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤º */
            transition: background-color 0.2s ease;
        }        
        
        #skip-button:hover, #unmute-button:hover {
            background-color: rgba(0, 0, 0, 0.9);
        }

        #time-display {
            text-align: center;
            margin-top: 15px;
            font-size: 16px;
            color: #555;
            height: 20px; /* è¡¨ç¤ºã‚¨ãƒªã‚¢ã®é«˜ã•ã‚’ç¢ºä¿ */
        }
    </style>
</head>
<body>

    <h1>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆç”¨å‹•ç”»</h1>

    <div class="video-container">
        <video id="main-video" src="main.mp4" controls></video>

        <div class="ad-overlay" id="ad-overlay">
            <video id="ad-video" src="ad.mp4" playsinline></video>
            
            <div id="play-button"></div>
            <div id="skip-button">ã‚¹ã‚­ãƒƒãƒ—</div>
            <div id="unmute-button">ğŸ”‡</div>
        </div>
    </div>

    <p id="time-display"></p>

    <script>
        // --- 1. è¦ç´ ã®å–å¾— ---
        const mainVideo = document.getElementById('main-video');
        const adOverlay = document.getElementById('ad-overlay');
        const adVideo = document.getElementById('ad-video');
        const playButton = document.getElementById('play-button');
        const skipButton = document.getElementById('skip-button');
        const unmuteButton = document.getElementById('unmute-button');
        const timeDisplay = document.getElementById('time-display');

        // --- 2. è¨­å®šå€¤ ---
        const skippableTime = 5000; // ã‚¹ã‚­ãƒƒãƒ—å¯èƒ½ã«ãªã‚‹ã¾ã§ã®æ™‚é–“ (ãƒŸãƒªç§’)
        let adStartTime; // åºƒå‘Šå†ç”Ÿé–‹å§‹æ™‚åˆ»ã‚’ä¿å­˜ã™ã‚‹å¤‰æ•°

        // --- 3. åˆæœŸåŒ– ---
        mainVideo.pause();

        // --- 4. ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š ---

        // (A) å†ç”Ÿãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰åºƒå‘Šã‚’å†ç”Ÿ
        playButton.addEventListener('click', () => {
            adVideo.play();
            playButton.style.display = 'none'; // å†ç”Ÿãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«
        });

        // (B) åºƒå‘Šã®å†ç”ŸãŒ"å®Ÿéš›ã«"å§‹ã¾ã£ãŸã‚‰ã€æ™‚åˆ»ã‚’è¨˜éŒ²ã—ã‚¹ã‚­ãƒƒãƒ—ãƒœã‚¿ãƒ³è¡¨ç¤ºã‚¿ã‚¤ãƒãƒ¼ã‚’é–‹å§‹
        adVideo.addEventListener('playing', () => {
            adStartTime = Date.now(); // é–‹å§‹æ™‚åˆ»ã‚’è¨˜éŒ²
            
            // æŒ‡å®šæ™‚é–“å¾Œã«ã‚¹ã‚­ãƒƒãƒ—ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
            setTimeout(() => {
                skipButton.style.display = 'block';
            }, skippableTime);
        });

        // (C) ã‚¹ã‚­ãƒƒãƒ—ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰æ™‚é–“ã‚’è¨ˆæ¸¬ã—ã€æœ¬ç·¨ã¸
        skipButton.addEventListener('click', () => {
            // adStartTimeãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿æ™‚é–“ã‚’è¨ˆç®—
            if (adStartTime) {
                const skipTime = Date.now();
                const elapsedTime = (skipTime - adStartTime) / 1000; // ç§’ã«å¤‰æ›
                timeDisplay.textContent = `åºƒå‘Šã¯ ${elapsedTime.toFixed(2)}ç§’ã§ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸã€‚\nã‚¢ãƒ³ã‚±ãƒ¼ãƒˆç”»é¢ã«æˆ»ã£ã¦ãã ã•ã„ã€‚`;
            }
            playMainVideo();
        });
        
        // (D) åºƒå‘ŠãŒæœ€å¾Œã¾ã§å†ç”Ÿã•ã‚ŒãŸã‚‰æœ¬ç·¨ã¸
        adVideo.addEventListener('ended', () => {
            timeDisplay.textContent = 'åºƒå‘ŠãŒæœ€å¾Œã¾ã§å†ç”Ÿã•ã‚Œã¾ã—ãŸã€‚';
            playMainVideo();
        });

        // (E) ãƒŸãƒ¥ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã§éŸ³å£°ã‚ªãƒ³/ã‚ªãƒ•ã‚’åˆ‡ã‚Šæ›¿ãˆ
        unmuteButton.addEventListener('click', () => {
            adVideo.muted = !adVideo.muted; // mutedãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’åè»¢ã•ã›ã‚‹
            unmuteButton.textContent = adVideo.muted ? 'ğŸ”Š' : 'ğŸ”‡'; // ãƒœã‚¿ãƒ³ã®çµµæ–‡å­—ã‚’å¤‰æ›´
        });

        // --- 5. ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•° ---

        // æœ¬ç·¨å‹•ç”»ã‚’å†ç”Ÿã™ã‚‹å‡¦ç†ã‚’ã¾ã¨ã‚ãŸé–¢æ•°
        function playMainVideo() {
            adOverlay.style.display = 'none'; // åºƒå‘Šã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’éè¡¨ç¤º
            adVideo.pause(); // å¿µã®ãŸã‚åºƒå‘Šå‹•ç”»ã‚’åœæ­¢
            adVideo.currentTime = 0; // åºƒå‘Šå‹•ç”»ã®å†ç”Ÿä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆ
            mainVideo.play(); // æœ¬ç·¨ã‚’å†ç”Ÿ
        }
    </script>

</body>

</html>
